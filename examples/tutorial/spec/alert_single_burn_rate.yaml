name: example

slos:
  - name: availability
    objective:
      ratio: 0.99
      windowRef: window-4w
    indicator:
      prometheus:
        errorRatio: >-
          sum by (job) (rate(http_requests_total{job="example", code!~"2.."}[$window])) /
          sum by (job) (rate(http_requests_total{job="example"}[$window]))
        level:
          - job
    alerts:
      - name: burnrate                                                      # UPDATED: Added an alert to page someone
        burnRate:                                                           #          when 2% of error budget is consumed within one hour
          consumedBudgetRatio: 0.02                                         #
          singleWindow:                                                     #
            windowRef: window-1h                                            #
        alerter:                                                            #
          prometheus:                                                       #
            name: SLOHighErrorRate                                          #
            labels:                                                         #
              severity: page                                                #
            annotations:                                                    #
              description: 2% error budget has been consumed within 1 hour  #
    windows:
      - name: window-5m
        rolling:
          duration: 5m
      - name: window-1h  # UPDATED: Added one hour rolling window for the alert
        rolling:         #
          duration: 1h   #
      - name: window-4w
        rolling:
          duration: 4w
